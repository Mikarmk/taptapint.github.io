Для самых хитрых, код тут
